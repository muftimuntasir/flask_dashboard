{% extends "base.html" %}
{% block content %}
<div class="card shadow-sm mb-4">
  <div class="card-body">
    <div class="row g-2 align-items-center">
      <div class="col-12 col-md-5">
        <div class="input-group">
          <span class="input-group-text">Search</span>
          <input id="searchInput" class="form-control hidden" placeholder="Search labels or text..." />
        </div>
      </div>

      <div class="col-6 col-md-3">
        <input id="fromInput" class="form-control" placeholder="From (date)" />
      </div>
      <div class="col-6 col-md-3">
        <input id="toInput" class="form-control" placeholder="To (date)" />
      </div>

      <div class="col-12 col-md-1 d-grid">
        <button id="searchBtn" class="btn btn-primary">Search</button>
      </div>
    </div>
  </div>
</div>


<!-- Quick stats -->
<div class="row g-3 mb-3">
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">OUTPATIENT</h6>
      <div id="outpatient_count" class="fs-4 fw-bold">—</div>
    </div>
  </div>
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">OUTPATIENT Income</h6>
      <div id="outpatient_income" class="fs-4 fw-bold">—</div>
    </div>
  </div>
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">OPTICS Sale</h6>
      <div id="optics_sale" class="fs-4 fw-bold">—</div>
    </div>
  </div>
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">OPT Income</h6>
      <div id="opd_income_stat" class="fs-4 fw-bold">—</div>
    </div>
  </div>
</div>

<div class="row g-3 mb-3">
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">PHYSIOTHERAPY BILL</h6>
      <div id="physio_bill_stat" class="fs-4 fw-bold">—</div>
    </div>
  </div>
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">Dental Income</h6>
      <div id="dental_income_stat" class="fs-4 fw-bold">—</div>
    </div>
  </div>
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">Dental OPD</h6>
      <div id="dental_opd_stat" class="fs-4 fw-bold">—</div>
    </div>
  </div>
</div>



<div class="row g-3 mb-3">
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">NO. of Surgery</h6>
      <div id="statCount" class="fs-4 fw-bold">—</div>
    </div>
  </div>
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">Pharmacy Sale</h6>
      <div id="statSum" class="fs-4 fw-bold">—</div>
    </div>
  </div>
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">PHYSIOTHERAPY BILL</h6>
      <div id="statAvg" class="fs-4 fw-bold">—</div>
    </div>
  </div>
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">EYE INVESTIGATION</h6>
      <div id="statCats" class="fs-4 fw-bold">—</div>
    </div>
  </div>
</div>

<div class="row g-3 mb-3">
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">CASH(Admission,bill,optics)</h6>
      <div id="statCount" class="fs-4 fw-bold">—</div>
    </div>
  </div>
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">Management Discount</h6>
      <div id="statSum" class="fs-4 fw-bold">—</div>
    </div>
  </div>
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">Avg / Record</h6>
      <div id="statAvg" class="fs-4 fw-bold">—</div>
    </div>
  </div>
  <div class="col-6 col-md-3">
    <div class="card h-100 text-center p-3 shadow-sm">
      <h6 class="mb-1">Other [Count/Amount]</h6>
      <div id="statCats" class="fs-4 fw-bold">—</div>
    </div>
  </div>
</div>

<!-- Charts grid -->
<div class="row g-3">
  <div class="col-12 col-lg-8">
    <div class="card p-3 shadow-sm">
      <h6>Time Series (Line)</h6>
      <canvas id="lineChart" ></canvas>
    </div>
  </div>

  <div class="col-12 col-lg-4">
    <div class="card p-3 shadow-sm mb-3">
      <h6>Category Breakdown (Bar)</h6>
      <canvas id="barChart"></canvas>
    </div>
    <div class="card p-3 shadow-sm">
      <h6>Top Labels (Doughnut)</h6>
      <canvas id="doughnutChart"></canvas>
    </div>
  </div>

  

  <!-- extra charts -->
  <div class="col-12 col-md-6">
    <div class="card p-3 shadow-sm">
      <h6>Stacked by Category (Stacked Bar)</h6>
      <canvas id="stackedChart"></canvas>
    </div>
  </div>

  <div class="col-12 col-md-6">
    <div class="card p-3 shadow-sm">
      <h6>Records Table</h6>
      <div class="table-responsive" style="max-height:260px; overflow:auto;">
        <table class="table table-sm table-hover mb-0">
          <thead class="table-light">
            <tr><th>#</th><th>Label</th><th>Category</th><th>Value</th><th>Date</th></tr>
          </thead>
          <tbody id="recordsTbody"></tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
<script>
  // init flatpickr on the date inputs
  flatpickr("#fromInput", { enableTime: true, dateFormat: "Y-m-d\\TH:i:S" });
  flatpickr("#toInput", { enableTime: true, dateFormat: "Y-m-d\\TH:i:S" });

  // you'll find the main dashboard logic in static/js/dashboard.js
</script>
{% endblock %}
